<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Scrap Pickup - Customer App</title>
  <link rel="icon" type="image/png" href="./scrap.png">

  <style>
    body { font-family: Arial, sans-serif; background: #f5f5f5; margin: 0; padding: 0; }
    .container { max-width: 400px; margin: 40px auto; background: #fff; padding: 30px; border-radius: 8px; box-shadow: 0 2px 6px #ccc; }
    h2 { text-align: center; }
    button, input, select { margin: 8px 0; padding: 8px; width: 100%; font-size: 1em; }
    .hidden { display: none; }
    .order-photo { width: 64px; height: 64px; object-fit: cover; margin: 5px 0; }
  </style>
</head>
<body>
  <div class="container">
    <h2>Customer Registration/Login</h2>
    <div id="login-screen">
      <input type="text" id="mobile" placeholder="Mobile Number" maxlength="10" />
      <button onclick="sendOTP()">Send OTP</button>
      <input type="text" id="otp" placeholder="Enter OTP" class="hidden"/>
      <button id="verify-btn" onclick="verifyOTP()" class="hidden">Verify OTP</button>
    </div>

    <div id="order-screen" class="hidden">
      <h3>New Scrap Pickup Order</h3>
      <label>
        Category:
        <select id="category">
          <option value="Plastic">Plastic</option>
          <option value="Paper">Paper</option>
          <option value="Metal">Metal</option>
        </select>
      </label>
      <input type="number" id="weight" placeholder="Approximate Weight (kg)" min="1" />
      <input type="file" id="photos" multiple accept="image/*" />
      <label>
        Pickup Date: <input type="date" id="date" />
      </label>
      <label>
        Pickup Time: <input type="time" id="pickup-time" />
      </label>
      <button onclick="confirmOrder()">Confirm Order</button>
    </div>

    <div id="history-screen" class="hidden">
      <h3>Order History</h3>
      <ul id="orders-list"></ul>
      <button onclick="logout()">Logout</button>
    </div>
  </div>
  <script>
    // Simple mock user and order data storage (in browser)
    const users = {}; // {mobile: {orders: []}}
    let currentUser = null;
    let otpCode = "";

    function sendOTP() {
      const mobile = document.getElementById('mobile').value;
      if (mobile.length !== 10) return alert("Enter valid mobile number");
      otpCode = "1234"; // For demo, fixed OTP - integrate real API for production
      document.getElementById('otp').classList.remove('hidden');
      document.getElementById('verify-btn').classList.remove('hidden');
      alert("OTP sent! (Use 1234 for demo)");
    }

    function verifyOTP() {
      const otpInput = document.getElementById('otp').value;
      if (otpInput === otpCode) {
        currentUser = document.getElementById('mobile').value;
        if (!users[currentUser]) users[currentUser] = {orders: []};
        document.getElementById('login-screen').classList.add('hidden');
        document.getElementById('order-screen').classList.remove('hidden');
      } else {
        alert("Invalid OTP");
      }
    }

    function confirmOrder() {
      const category = document.getElementById('category').value;
      const weight = document.getElementById('weight').value;
      const date = document.getElementById('date').value;
      const time = document.getElementById('pickup-time').value;
      const photosInput = document.getElementById('photos');
      if (!category || !weight || !date || !time || photosInput.files.length === 0) {
        alert("All fields required incl. photos");
        return;
      }
      // Simulate photo upload by storing URLs locally
      const photos = [];
      for (const file of photosInput.files) {
        photos.push(URL.createObjectURL(file));
      }
      const order = {category, weight, date, time, photos, status: "Pending"};
      users[currentUser].orders.push(order);
      alert("Order confirmed. Pickup will be scheduled.");
      showOrderHistory();
    }

    function showOrderHistory() {
      document.getElementById('order-screen').classList.add('hidden');
      document.getElementById('history-screen').classList.remove('hidden');
      const ordList = document.getElementById('orders-list');
      ordList.innerHTML = "";
      users[currentUser].orders.forEach((ord, idx) => {
        let pics = ord.photos.map(url => `<img src="${url}" class="order-photo">`).join("");
        ordList.innerHTML += `<li>
          <strong>Category:</strong> ${ord.category}<br>
          <strong>Weight:</strong> ${ord.weight} kg<br>
          <strong>Date:</strong> ${ord.date}<br>
          <strong>Time:</strong> ${ord.time}<br>
          <strong>Status:</strong> ${ord.status}<br>
          ${pics}
        </li>`;
      });
    }

    function logout() {
      currentUser = null;
      document.getElementById('history-screen').classList.add('hidden');
      document.getElementById('login-screen').classList.remove('hidden');
      document.getElementById('otp').classList.add('hidden');
      document.getElementById('verify-btn').classList.add('hidden');
      document.getElementById('mobile').value = "";
      document.getElementById('otp').value = "";
    }
  </script>
</body>
</html>


