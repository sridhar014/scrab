<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Scrap Pickup - Admin Panel</title>
  <link rel="icon" type="image/png" href="./scrap.png">

  <style>
    body { font-family: Arial, sans-serif; background: #eef; }
    .container { max-width: 700px; margin: 40px auto; background: #fff; padding: 30px; border-radius: 8px; box-shadow: 0 2px 8px #aaa; }
    h2 { text-align: center; }
    table { width: 100%; border-collapse: collapse; margin: 10px 0;}
    th, td { border: 1px solid #ccc; padding: 8px; }
    .order-photo { width: 64px; height: 64px; object-fit: cover; }
    button { padding: 4px 12px; margin: 2px; }
  </style>
</head>
<body>
  <div class="container">
    <h2>Admin Dashboard</h2>
    <button onclick="loadOrders()">Load Customer Requests</button>
    <table>
      <thead>
        <tr>
          <th>Customer</th>
          <th>Category</th>
          <th>Weight (kg)</th>
          <th>Date</th>
          <th>Time</th>
          <th>Photos</th>
          <th>Status</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody id="orders-table"></tbody>
    </table>
  </div>
  <script>
    // Simulate the orders DB from the previous customer-side code
    let users = window.localStorage.getItem('users') ? JSON.parse(window.localStorage.getItem('users')) : {};

    function loadOrders() {
      let tbl = document.getElementById('orders-table');
      tbl.innerHTML = "";
      Object.keys(users).forEach(cust => {
        users[cust].orders.forEach((ord, idx) => {
          let pics = ord.photos.map(url => `<img src="${url}" class="order-photo">`).join("");
          tbl.innerHTML += `<tr>
            <td>${cust}</td>
            <td>${ord.category}</td>
            <td>${ord.weight}</td>
            <td>${ord.date}</td>
            <td>${ord.time}</td>
            <td>${pics}</td>
            <td>${ord.status}</td>
            <td>
              <button onclick="setStatus('${cust}',${idx},'Scheduled')">Accept</button>
              <button onclick="setStatus('${cust}',${idx},'Rejected')">Reject</button>
              <button onclick="setStatus('${cust}',${idx},'Completed')">Complete</button>
            </td>
          </tr>`;
        });
      });
    }

    function setStatus(cust, idx, status) {
      users[cust].orders[idx].status = status;
      window.localStorage.setItem('users', JSON.stringify(users));
      loadOrders();
    }
  </script> 
</body>
</html>
